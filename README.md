# Single and multiple phenotype QTL analyses of downy mildew resistance in interspecific grapevines
This repository contains the genetic and phenotypic data and code used in a recently accepted paper (link coming soon) in the Theoretical and Applied Genetics journal.

The genetic maps used in the analyses were initially generated by [Hyma et al. (2015)](http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0134880) using the 12X.0 version of the grapevine genome. The 12x0_to_12x2_conversion folder in the repository contains the necessary information to convert between the 12X.0 physical locations of SNPs and the 12X.2 (current genome version) physical locations of SNPs. In the genetic maps, 1 represents the heterozygous allele and 2 the homozygous allele. Further, chromosomes 1 through 19 represent chromosomes 1 through 19 in the maternal genetic map, and chromosomes 20 to 38 represent chromosomes 1 through 19 in the paternal genetic map.

Repository outline:
* MixedModels
  * HCallHRpheno.csv – Hypersensitive response (HR) phenotypes (2 days post-inoculation [dpi]) for the HC ('Horizon' x *Vitis cinerea* B9) family genotypes across experiments across years.
  * HCallsporCVpheno.csv – Sporulation (computer vision) phenotypes for the HC family genotypes for multiple dpi across experiments across years. The file also contains leaf trichome phenotypes (2 dpi) to be used in the model as covariates.
  * HCallspormanpheno.csv – Sporulation (manual) phenotypes for the HC family genotypes for multiple dpi across experiments across years.
  * HCalltrichomespheno.csv – Leaf trichome phenotypes (2 dpi) for the HC family genotypes for multiple dpi across experiments across years.
  * RHallHRpheno.csv – HR phenotypes (2 dpi) for the RH (*Vitis rupestris* B38 x 'Horizon') family genotypes across experiments across years.
  * RHallsporCVpheno.csv – Sporulation (computer vision) phenotypes for the RH family genotypes for multiple dpi across experiments across years.
  * RHallspormanpheno.csv – Sporulation (manual) phenotypes for the RH family genotypes for multiple dpi across experiments across years.
  * mixedmodels.R – R code necessary to analyze the data using mixed models.

* SinglePhenotypeQTL
  * HCallphenoandmap.csv – HC family breeding values (sporulation [computer vision and manual], HR, and leaf trichomes) and genetic map in Rqtl format.
  * RHallphenoandmap.csv – RH family Breeding values (sporulation [computer vision and manual] and HR) and genetic map in Rqtl format.
  * singlephenotype.R – R code necessary to find QTL using the breeding values of one trait at a time.

* BayesianNetworks
  * HCallphenoandmap.csv – same as above.
  * RHallphenoandmap.csv – same as above.
  * HCnets.rds and RHnets.rds– 1000 networks saved for loading if desired .
  * bn.R – R code necessary to find QTL as well as effects among traits using the breeding values of all traits at the same time.

* SingleTimePointQTL
  * HC2015CV.csv – 2015 HC family sporulation (computer vision) and leaf trichomes (2 dpi) phenotypes for multiple dpi across experiments across years and genetic map in Rqtl format.
  * HC2015man.csv – 2015 HC family sporulation (manual) and HR (2 dpi) phenotypes for multiple dpi across experiments across years and genetic map in Rqtl format.
  * HC2016CV.csv – 2016 HC family sporulation (computer vision) and leaf trichomes (2 dpi) phenotypes for multiple dpi across experiments across years and genetic map in Rqtl format.
  * HC2016man.csv – 2016 HC family sporulation (manual) and HR (2 dpi) phenotypes for multiple dpi across experiments across years and genetic map in Rqtl format.
  * RH2015CV.csv – 2015 RH family sporulation (computer vision) phenotypes for multiple dpi across experiments across years and genetic map in Rqtl format.
  * RH2015man.csv – 2015 RH family sporulation (manual) and HR (2 dpi) phenotypes for multiple dpi across experiments across years and genetic map in Rqtl format.
  * RH2016CV.csv – 2016 RH family sporulation (computer vision) phenotypes for multiple dpi across experiments across years and genetic map in Rqtl format.
  * RH2016man.csv – 2016 RH family sporulation (manual) and HR (2 dpi) phenotypes for multiple dpi across experiments across years and genetic map in Rqtl format.
  * singletimepoint.R – R code necessary to find QTL for a single time point in a single experiment in a single year.

* RNA-Seq
  * QTLalleleinfo.xlsx – Allele information for the two QTL on chromosome 14 from the RH family.
  * rnaseqpipeline.sh – Shell code to obtain transcript expression levels for genes from fastq RNA-Seq files.
  * ballgown.R – R code necessary to find differentially transcribed genes.
